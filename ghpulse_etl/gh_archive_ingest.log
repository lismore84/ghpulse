2025-12-23 16:40:38,064 - INFO - 开始处理: 2024-01-01 15:00
2025-12-23 16:40:38,064 - INFO - 下载地址: https://data.gharchive.org/2024-01-01-15.json.gz
2025-12-23 16:40:38,190 - INFO - ✓ 数据库连接成功
2025-12-23 16:40:38,190 - INFO - 正在加载已存在的ID...
2025-12-23 16:40:38,402 - INFO -   已加载 33773 个用户
2025-12-23 16:40:38,672 - INFO -   已加载 71713 个仓库
2025-12-23 16:40:38,728 - INFO -   已加载 7234 个组织
2025-12-23 16:40:38,728 - INFO - 正在下载并解压...
2025-12-23 16:41:22,803 - ERROR - ✗ 处理失败: ('Connection broken: IncompleteRead(77647552 bytes read, 5508597 more expected)', IncompleteRead(77647552 bytes read, 5508597 more expected))
2025-12-23 16:41:39,185 - INFO - 开始处理: 2024-01-01 15:00
2025-12-23 16:41:39,186 - INFO - 下载地址: https://data.gharchive.org/2024-01-01-15.json.gz
2025-12-23 16:41:39,324 - INFO - ✓ 数据库连接成功
2025-12-23 16:41:39,326 - INFO - 正在加载已存在的ID...
2025-12-23 16:41:39,622 - INFO -   已加载 33773 个用户
2025-12-23 16:41:39,911 - INFO -   已加载 71713 个仓库
2025-12-23 16:41:39,989 - INFO -   已加载 7234 个组织
2025-12-23 16:41:39,989 - INFO - 正在下载并解压...
2025-12-23 16:42:07,713 - INFO - ✓ 下载完成，共 180387 条事件
2025-12-23 16:42:07,713 - INFO - 开始批量处理...
2025-12-23 16:42:07,714 - INFO -   [1/4] 收集实体数据...
2025-12-23 16:42:07,941 - INFO -   [2/4] 批量插入用户/仓库/组织...
2025-12-23 16:42:09,912 - INFO -     插入 35324 个新用户
2025-12-23 16:42:12,547 - INFO -     插入 45867 个新仓库
2025-12-23 16:42:12,777 - INFO -     插入 4272 个新组织
2025-12-23 16:42:12,818 - INFO -   [3/4] 批量插入Payload...
2025-12-23 16:48:03,491 - INFO - 开始处理: 2024-01-01 15:00
2025-12-23 16:48:03,600 - INFO - ✓ 数据库连接成功
2025-12-23 16:48:03,600 - INFO - 正在加载已存在的ID...
2025-12-23 16:48:04,456 - INFO -   已有: 69097用户, 117580仓库, 11506组织
2025-12-23 16:48:04,456 - INFO - 正在下载并解压...
2025-12-23 16:49:02,926 - INFO - ✓ 下载完成，共 180387 条事件
2025-12-23 16:49:02,926 - INFO -   [1/3] 批量插入用户/仓库/组织...
2025-12-23 16:49:03,187 - INFO -     插入 0 个新仓库
2025-12-23 16:49:03,209 - INFO -     ✓ 实体插入完成并提交
2025-12-23 16:49:03,210 - INFO -   [2/3] 批量插入Payload...
2025-12-23 16:49:09,859 - INFO -     批量插入 180387 个Payload
2025-12-23 16:49:09,971 - INFO -     ✓ Payload插入完成并提交
2025-12-23 16:49:09,973 - INFO -   [3/3] 批量插入事件...
2025-12-23 16:49:11,272 - ERROR - ✗ 批量处理失败: (1644, 'Invalid repo_id: 仓库不存在')
2025-12-23 16:49:11,274 - ERROR - ✗ 处理失败: (1644, 'Invalid repo_id: 仓库不存在')
2025-12-23 16:53:40,273 - INFO - ✓ 配置验证通过
2025-12-23 16:53:40,273 - INFO - 开始处理: 2024-01-01 15:00
2025-12-23 16:53:40,411 - INFO - ✓ 数据库连接成功
2025-12-23 16:53:40,438 - INFO - 正在加载已存在的ID...
2025-12-23 16:53:40,531 - INFO -   已有: 0用户, 0仓库, 0组织
2025-12-23 16:53:40,531 - INFO - 正在下载...
2025-12-23 16:53:41,766 - INFO - 正在解压...
2025-12-23 16:54:32,811 - INFO - ✓ 下载完成，共 180387 条事件
2025-12-23 16:54:32,811 - INFO -   [1/4] 收集实体数据...
2025-12-23 16:54:32,931 - INFO -   [2/4] 批量插入实体...
2025-12-23 16:54:34,744 - INFO -     插入 39030 个新用户
2025-12-23 16:54:39,834 - INFO -     插入 54822 个新仓库
2025-12-23 16:54:40,457 - INFO -     插入 6110 个新组织
2025-12-23 16:54:40,498 - INFO -     ✓ 实体插入完成
2025-12-23 16:54:40,498 - INFO -   [3/4] 批量插入Payload...
2025-12-23 16:54:48,664 - INFO -     插入 180387 个Payload
2025-12-23 16:54:48,769 - INFO -     ✓ Payload插入完成
2025-12-23 16:54:48,769 - INFO -   [4/4] 批量插入事件...
2025-12-23 16:54:51,320 - ERROR - ✗ 批量处理失败: (1644, 'Invalid repo_id: 仓库不存在')
2025-12-23 16:54:51,332 - ERROR - ✗ 处理失败: (1644, 'Invalid repo_id: 仓库不存在')
2025-12-23 17:01:58,816 - INFO - ✓ 配置验证通过
2025-12-23 17:01:58,816 - INFO - 开始处理: 2024-01-01 15:00
2025-12-23 17:01:58,956 - INFO - ✓ 数据库连接成功
2025-12-23 17:01:58,957 - INFO - 正在禁用触发器...
2025-12-23 17:01:58,985 - ERROR -   ✗ 禁用触发器失败: (1142, "TRIGGER command denied to user 'ingest_user'@'61.136.26.17' for table 'events'")
2025-12-23 17:01:59,010 - INFO - 正在加载已存在的ID...
2025-12-23 17:01:59,085 - INFO -   已有: 0用户, 0仓库, 0组织
2025-12-23 17:01:59,085 - INFO - 正在下载...
2025-12-23 17:02:00,288 - INFO - 正在解压...
2025-12-23 17:04:49,967 - INFO - ✓ 配置验证通过
2025-12-23 17:04:49,968 - INFO - 开始处理: 2024-01-01 15:00
2025-12-23 17:04:50,101 - INFO - ✓ 管理员连接成功（admin_user）
2025-12-23 17:04:50,101 - INFO - 正在禁用触发器...
2025-12-23 17:04:50,136 - INFO -   ✓ 已删除触发器: trg_validate_event_insert
2025-12-23 17:04:50,175 - INFO -   ✓ 已删除触发器: trg_after_event_insert
2025-12-23 17:04:50,213 - INFO -   ✓ 已删除触发器: trg_update_user_repo_relation
2025-12-23 17:04:50,238 - INFO - ✓ 触发器已禁用
2025-12-23 17:04:50,381 - INFO - ✓ 数据写入连接成功（ingest_user）
2025-12-23 17:04:50,408 - INFO - 正在加载已存在的ID...
2025-12-23 17:04:50,487 - INFO -   已有: 0用户, 0仓库, 0组织
2025-12-23 17:04:50,487 - INFO - 正在下载...
2025-12-23 17:04:51,666 - INFO - 正在解压...
2025-12-23 17:05:43,617 - INFO - ✓ 下载完成，共 180387 条事件
2025-12-23 17:05:43,619 - INFO -   [1/4] 收集实体数据...
2025-12-23 17:05:43,742 - INFO -   [2/4] 批量插入实体...
2025-12-23 17:05:46,376 - INFO -     插入 39030 个新用户
2025-12-23 17:05:51,281 - INFO -     插入 54822 个新仓库
2025-12-23 17:05:51,826 - INFO -     插入 6110 个新组织
2025-12-23 17:05:51,869 - INFO -     ✓ 实体插入完成
2025-12-23 17:05:51,871 - INFO -   [3/4] 批量插入Payload...
2025-12-23 17:06:00,039 - INFO -     插入 180387 个Payload
2025-12-23 17:06:00,150 - INFO -     ✓ Payload插入完成
2025-12-23 17:06:00,150 - INFO -   [4/4] 批量插入事件...
2025-12-23 17:06:19,757 - INFO -     插入 180386 条事件，跳过 0 条
2025-12-23 17:06:19,929 - INFO -     ✓ 事件插入完成
2025-12-23 17:06:19,964 - INFO - ✓ 数据插入完成
2025-12-23 17:06:19,964 - INFO - ============================================================
2025-12-23 17:06:19,966 - INFO - 处理统计:
2025-12-23 17:06:19,966 - INFO -   插入事件: 180386
2025-12-23 17:06:19,966 - INFO -   新增用户: 39030
2025-12-23 17:06:19,967 - INFO -   新增仓库: 54822
2025-12-23 17:06:19,967 - INFO -   跳过: 0
2025-12-23 17:06:19,967 - INFO - ============================================================
2025-12-23 17:06:20,098 - INFO - ✓ 数据写入连接成功（ingest_user）
2025-12-23 17:06:20,098 - INFO - 正在批量更新统计数据...
2025-12-23 17:06:20,098 - INFO -   更新用户统计...
2025-12-23 17:06:21,109 - INFO -     更新了 39030 个用户
2025-12-23 17:06:21,109 - INFO -   更新仓库统计...
2025-12-23 17:06:22,548 - INFO -     更新了 54822 个仓库
2025-12-23 17:06:22,548 - INFO -   更新用户-仓库关联...
2025-12-23 17:06:24,607 - ERROR -   ✗ 统计更新失败: (1216, 'Cannot add or update a child row: a foreign key constraint fails')
2025-12-23 17:06:24,731 - INFO - ✓ 管理员连接成功（admin_user）
2025-12-23 17:06:24,731 - INFO - 正在重新启用触发器...
2025-12-23 17:06:24,821 - INFO -   ✓ 验证触发器已重新启用
2025-12-23 17:11:37,497 - INFO - ✓ 配置验证通过
2025-12-23 17:11:37,497 - INFO - 开始处理: 2024-01-01 15:00
2025-12-23 17:11:37,623 - INFO - ✓ 管理员连接成功（admin_user）
2025-12-23 17:11:37,623 - INFO - 正在禁用触发器...
2025-12-23 17:11:37,657 - INFO -   ✓ 已删除触发器: trg_validate_event_insert
2025-12-23 17:11:37,696 - INFO -   ✓ 已删除触发器: trg_after_event_insert
2025-12-23 17:11:37,735 - INFO -   ✓ 已删除触发器: trg_update_user_repo_relation
2025-12-23 17:11:37,759 - INFO - ✓ 触发器已禁用
2025-12-23 17:11:37,870 - INFO - ✓ 数据写入连接成功（ingest_user）
2025-12-23 17:11:37,894 - INFO - 正在加载已存在的ID...
2025-12-23 17:11:37,969 - INFO -   已有: 0用户, 0仓库, 0组织
2025-12-23 17:11:37,969 - INFO - 正在下载...
2025-12-23 17:11:38,384 - INFO - 正在解压...
2025-12-23 17:12:13,863 - INFO - ✓ 下载完成，共 180387 条事件
2025-12-23 17:12:13,863 - INFO -   [1/4] 收集实体数据...
2025-12-23 17:12:13,992 - INFO -   [2/4] 批量插入实体...
2025-12-23 17:12:16,368 - INFO -     插入 39030 个新用户
2025-12-23 17:12:20,424 - INFO -     插入 54822 个新仓库
2025-12-23 17:12:20,889 - INFO -     插入 6110 个新组织
2025-12-23 17:12:20,929 - INFO -     ✓ 实体插入完成
2025-12-23 17:12:20,931 - INFO -   [3/4] 批量插入Payload...
2025-12-23 17:12:29,218 - INFO -     插入 180387 个Payload
2025-12-23 17:12:29,321 - INFO -     ✓ Payload插入完成
2025-12-23 17:12:29,321 - INFO -   [4/4] 批量插入事件...
2025-12-23 17:12:48,989 - INFO -     插入 180386 条事件，跳过 0 条
2025-12-23 17:12:49,154 - INFO -     ✓ 事件插入完成
2025-12-23 17:12:49,191 - INFO - ✓ 数据插入完成
2025-12-23 17:12:49,191 - INFO - ============================================================
2025-12-23 17:12:49,193 - INFO - 处理统计:
2025-12-23 17:12:49,193 - INFO -   插入事件: 180386
2025-12-23 17:12:49,193 - INFO -   新增用户: 39030
2025-12-23 17:12:49,193 - INFO -   新增仓库: 54822
2025-12-23 17:12:49,193 - INFO -   跳过: 0
2025-12-23 17:12:49,193 - INFO - ============================================================
2025-12-23 17:12:49,324 - INFO - ✓ 数据写入连接成功（ingest_user）
2025-12-23 17:12:49,326 - INFO - 正在批量更新统计数据...
2025-12-23 17:12:49,326 - INFO -   更新用户统计...
2025-12-23 17:12:50,336 - INFO -     更新了 39030 个用户
2025-12-23 17:12:50,336 - INFO -   更新仓库统计...
2025-12-23 17:12:51,739 - INFO -     更新了 54822 个仓库
2025-12-23 17:12:51,741 - INFO -   更新用户-仓库关联...
2025-12-23 17:12:54,218 - INFO -     更新了 61138 条关联
2025-12-23 17:12:54,278 - INFO -   ✓ 统计数据更新完成
2025-12-23 17:12:54,410 - INFO - ✓ 管理员连接成功（admin_user）
2025-12-23 17:12:54,411 - INFO - 正在重新启用触发器...
2025-12-23 17:12:54,512 - INFO -   ✓ 验证触发器已重新启用
